<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MemoNest - 备忘录应用</title>
    <style>
        /* 全局样式 */
        :root {
            --primary-color: #007AFF;
            --secondary-color: #5AC8FA;
            --background-color: #F2F2F7;
            --card-color: #FFFFFF;
            --text-color: #000000;
            --text-secondary: #8E8E93;
            --border-color: #E5E5EA;
            --success-color: #34C759;
            --warning-color: #FF9500;
            --danger-color: #FF3B30;
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        [data-theme="dark"] {
            --background-color: #1C1C1E;
            --card-color: #2C2C2E;
            --text-color: #FFFFFF;
            --text-secondary: #8E8E93;
            --border-color: #38383A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: var(--font-family);
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: var(--font-family);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            position: relative;
            height: 100vh;
            width: 100vw;
        }

        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 3px;
        }

        [data-theme="dark"] ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
        }

        /* 主容器 */
        .app-container {
            position: relative;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* 顶部导航栏 */
        .header {
            height: 60px;
            width: 100%;
            background-color: var(--card-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            position: relative;
            z-index: 10;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            text-align: center;
        }

        .menu-button, .search-button, .add-button {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 24px;
            border-radius: 50%;
            transition: background-color 0.2s;
        }

        .menu-button:active, .search-button:active, .add-button:active {
            background-color: rgba(0, 0, 0, 0.05);
        }

        /* 内容区域 */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            position: relative;
        }

        /* 笔记卡片 */
        .note-card {
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
            touch-action: pan-y; /* 允许垂直滚动，但水平滑动会被捕获 */
        }

        .note-card:active {
            transform: scale(0.98);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
        }

        /* 滑动删除相关样式 */
        .note-card-wrapper {
            position: relative;
            margin-bottom: 16px;
            overflow: hidden;
            border-radius: 12px;
            touch-action: pan-x pan-y;
        }

        .note-card-content {
            width: 100%;
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
            position: relative;
            z-index: 1;
        }

        .note-card-delete {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            width: 80px;
            background-color: var(--danger-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 500;
            z-index: 0;
            border-top-right-radius: 12px;
            border-bottom-right-radius: 12px;
        }

        .note-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }

        .note-preview {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .note-date {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .note-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .note-tag {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            background-color: rgba(0, 122, 255, 0.1);
            color: var(--primary-color);
        }

        /* 侧边菜单 */
        .side-menu {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 280px;
            background-color: var(--card-color);
            z-index: 100;
            transform: translateX(-100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .side-menu.open {
            transform: translateX(0);
        }

        .menu-header {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--border-color);
            padding: 0 20px;
        }

        .app-logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .menu-items {
            flex: 1;
            overflow-y: auto;
            padding: 16px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text-color);
            text-decoration: none;
            transition: background-color 0.2s;
            cursor: pointer;
        }

        .menu-item:active {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .menu-item-icon {
            margin-right: 12px;
            font-size: 20px;
            width: 24px;
            text-align: center;
            color: var(--primary-color);
        }

        .menu-item-text {
            font-size: 16px;
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            background-color: rgba(0, 0, 0, 0.4);
            z-index: 99;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .menu-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        /* 编辑页面 */
        .edit-page {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            background-color: var(--background-color);
            z-index: 50;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
        }

        .edit-page.open {
            transform: translateY(0);
        }

        .edit-header {
            height: 60px;
            width: 100%;
            background-color: var(--card-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .cancel-button, .save-button {
            padding: 8px 16px;
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }

        .save-button {
            font-weight: 600;
        }

        .edit-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .edit-title {
            width: 100%;
            font-size: 20px;
            font-weight: 600;
            padding: 12px 16px;
            margin-bottom: 16px;
            border: none;
            border-radius: 12px;
            background-color: var(--card-color);
            color: var(--text-color);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .edit-body {
            width: 100%;
            height: calc(100% - 80px);
            font-size: 16px;
            padding: 16px;
            border: none;
            border-radius: 12px;
            background-color: var(--card-color);
            color: var(--text-color);
            resize: none;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .edit-title:focus, .edit-body:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .edit-tags {
            margin-top: 16px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .edit-tag {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            background-color: rgba(0, 122, 255, 0.1);
            color: var(--primary-color);
            border-radius: 16px;
            font-size: 14px;
        }

        .edit-tag-remove {
            margin-left: 6px;
            cursor: pointer;
        }

        .add-tag {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--text-secondary);
            border-radius: 16px;
            font-size: 14px;
            cursor: pointer;
        }

        /* 搜索页面 */
        .search-page {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            background-color: var(--background-color);
            z-index: 50;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
        }

        .search-page.open {
            transform: translateY(0);
        }

        .search-header {
            height: 60px;
            width: 100%;
            background-color: var(--card-color);
            display: flex;
            align-items: center;
            padding: 0 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .search-input {
            flex: 1;
            height: 36px;
            padding: 0 12px;
            border: none;
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--text-color);
            font-size: 16px;
        }

        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .search-cancel {
            padding: 0 16px;
            color: var(--primary-color);
            font-size: 16px;
            cursor: pointer;
        }

        .search-results {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        /* 已删除笔记页面 */
        .deleted-page {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            background-color: var(--background-color);
            z-index: 50;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
        }

        .deleted-page.open {
            transform: translateY(0);
        }

        .deleted-header {
            height: 60px;
            width: 100%;
            background-color: var(--card-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .deleted-title {
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            text-align: center;
        }

        .deleted-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .deleted-actions {
            display: flex;
            justify-content: space-between;
            padding: 16px;
        }

        .restore-all, .delete-all {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
        }

        .restore-all {
            background-color: var(--primary-color);
            color: white;
        }

        .delete-all {
            background-color: var(--danger-color);
            color: white;
        }

        /* 设置页面 */
        .settings-page {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            background-color: var(--background-color);
            z-index: 50;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
        }

        .settings-page.open {
            transform: translateY(0);
        }

        .settings-header {
            height: 60px;
            width: 100%;
            background-color: var(--card-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .settings-title {
            font-size: 18px;
            font-weight: 600;
            flex: 1;
            text-align: center;
        }

        .settings-content {
            flex: 1;
            overflow-y: auto;
        }

        .settings-group {
            margin: 16px 0;
            background-color: var(--card-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .settings-group-title {
            padding: 8px 16px;
            font-size: 14px;
            color: var(--text-secondary);
            background-color: var(--background-color);
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item-label {
            font-size: 16px;
            color: var(--text-color);
        }

        .settings-item-value {
            font-size: 16px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
        }

        .settings-switch {
            position: relative;
            width: 50px;
            height: 30px;
            border-radius: 15px;
            background-color: rgba(0, 0, 0, 0.1);
            transition: background-color 0.2s;
            cursor: pointer;
        }

        .settings-switch.active {
            background-color: var(--success-color);
        }

        .settings-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background-color: white;
            transition: transform 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .settings-switch.active::after {
            transform: translateX(20px);
        }

        /* 联系我们弹窗 */
        .contact-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 300px;
            background-color: var(--card-color);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .contact-popup.open {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }

        .contact-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            text-align: center;
        }

        .contact-email {
            font-size: 16px;
            text-align: center;
            margin-bottom: 24px;
            color: var(--primary-color);
        }

        .contact-close {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
        }

        /* 标签选择弹窗 */
        .tag-popup {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--card-color);
            border-top-left-radius: 16px;
            border-top-right-radius: 16px;
            padding: 24px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
            z-index: 200;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .tag-popup.open {
            transform: translateY(0);
        }

        .tag-popup-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 24px;
        }

        .tag-item {
            padding: 8px 16px;
            border-radius: 16px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .tag-item.selected {
            background-color: var(--primary-color) !important;
            color: white !important;
        }

        .tag-popup-actions {
            display: flex;
            justify-content: flex-end;
        }

        .tag-popup-cancel, .tag-popup-confirm {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin-left: 12px;
        }

        .tag-popup-cancel {
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--text-color);
        }

        .tag-popup-confirm {
            background-color: var(--primary-color);
            color: white;
        }

        /* 空状态 */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 32px;
            text-align: center;
        }

        .empty-icon {
            font-size: 64px;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .empty-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }

        .empty-description {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .empty-action {
            padding: 8px 16px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        /* 加载动画 */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* 响应式设计 */
        @media (min-width: 768px) {
            .side-menu {
                width: 320px;
            }

            .edit-page, .search-page, .deleted-page, .settings-page {
                width: 80%;
                max-width: 800px;
                left: 50%;
                transform: translateX(-50%) translateY(100%);
                border-top-left-radius: 16px;
                border-top-right-radius: 16px;
            }

            .edit-page.open, .search-page.open, .deleted-page.open, .settings-page.open {
                transform: translateX(-50%) translateY(0);
            }
        }

        /* 动画效果 */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }

        .slide-up {
            animation: slideUp 0.3s ease forwards;
        }

        /* 工具类 */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 顶部导航栏 -->
        <div class="header">
            <button class="menu-button" id="menuButton">☰</button>
            <div class="header-title" data-lang="zh">备忘录</div>
            <div class="header-title hidden" data-lang="en">Notes</div>
            <button class="search-button" id="searchButton">🔍</button>
            <button class="add-button" id="addButton">+</button>
        </div>

        <!-- 内容区域 -->
        <div class="content" id="notesContainer">
            <!-- 笔记列表将通过JavaScript动态生成 -->
        </div>

        <!-- 侧边菜单 -->
        <div class="side-menu" id="sideMenu">
            <div class="menu-header">
                <div class="app-logo">MemoNest</div>
            </div>
            <div class="menu-items">
                <div class="menu-item" id="menuHome">
                    <div class="menu-item-icon">🏠</div>
                    <div class="menu-item-text" data-lang="zh">主页</div>
                    <div class="menu-item-text hidden" data-lang="en">Home</div>
                </div>
                <div class="menu-item" id="menuDeleted">
                    <div class="menu-item-icon">🗑️</div>
                    <div class="menu-item-text" data-lang="zh">最近删除</div>
                    <div class="menu-item-text hidden" data-lang="en">Recently Deleted</div>
                </div>
                <div class="menu-item" id="menuContact">
                    <div class="menu-item-icon">✉️</div>
                    <div class="menu-item-text" data-lang="zh">联系我们</div>
                    <div class="menu-item-text hidden" data-lang="en">Contact Us</div>
                </div>
                <div class="menu-item" id="menuSettings">
                    <div class="menu-item-icon">⚙️</div>
                    <div class="menu-item-text" data-lang="zh">设置</div>
                    <div class="menu-item-text hidden" data-lang="en">Settings</div>
                </div>
            </div>
        </div>
        <div class="menu-overlay" id="menuOverlay"></div>

        <!-- 编辑页面 -->
        <div class="edit-page" id="editPage">
            <div class="edit-header">
                <button class="cancel-button" id="cancelEdit" data-lang="zh">取消</button>
                <button class="cancel-button hidden" id="cancelEdit-en" data-lang="en">Cancel</button>
                <button class="save-button" id="saveNote" data-lang="zh">保存</button>
                <button class="save-button hidden" id="saveNote-en" data-lang="en">Save</button>
            </div>
            <div class="edit-content">
                <input type="text" class="edit-title" id="editTitle" data-lang-placeholder="zh" placeholder="标题">
                <input type="text" class="edit-title hidden" id="editTitle-en" data-lang-placeholder="en" placeholder="Title">
                <textarea class="edit-body" id="editBody" data-lang-placeholder="zh" placeholder="开始输入..."></textarea>
                <textarea class="edit-body hidden" id="editBody-en" data-lang-placeholder="en" placeholder="Start typing..."></textarea>
                <div class="edit-tags" id="editTags">
                    <!-- 标签将通过JavaScript动态生成 -->
                </div>
                <div class="add-tag" id="addTag">
                    <span data-lang="zh">+ 添加标签</span>
                    <span class="hidden" data-lang="en">+ Add Tag</span>
                </div>
            </div>
        </div>

        <!-- 搜索页面 -->
        <div class="search-page" id="searchPage">
            <div class="search-header">
                <input type="text" class="search-input" id="searchInput" data-lang-placeholder="zh" placeholder="搜索笔记...">
                <input type="text" class="search-input hidden" id="searchInput-en" data-lang-placeholder="en" placeholder="Search notes...">
                <div class="search-cancel" id="cancelSearch" data-lang="zh">取消</div>
                <div class="search-cancel hidden" id="cancelSearch-en" data-lang="en">Cancel</div>
            </div>
            <div class="search-results" id="searchResults">
                <!-- 搜索结果将通过JavaScript动态生成 -->
            </div>
        </div>

        <!-- 已删除笔记页面 -->
        <div class="deleted-page" id="deletedPage">
            <div class="deleted-header">
                <button class="menu-button" id="backFromDeleted">←</button>
                <div class="deleted-title" data-lang="zh">最近删除</div>
                <div class="deleted-title hidden" data-lang="en">Recently Deleted</div>
                <div style="width: 40px;"></div>
            </div>
            <div class="deleted-content" id="deletedContainer">
                <!-- 已删除笔记将通过JavaScript动态生成 -->
            </div>
            <div class="deleted-actions">
                <div class="restore-all" id="restoreAll" data-lang="zh">全部恢复</div>
                <div class="restore-all hidden" id="restoreAll-en" data-lang="en">Restore All</div>
                <div class="delete-all" id="deleteAll" data-lang="zh">全部删除</div>
                <div class="delete-all hidden" id="deleteAll-en" data-lang="en">Delete All</div>
            </div>
        </div>

        <!-- 设置页面 -->
        <div class="settings-page" id="settingsPage">
            <div class="settings-header">
                <button class="menu-button" id="backFromSettings">←</button>
                <div class="settings-title" data-lang="zh">设置</div>
                <div class="settings-title hidden" data-lang="en">Settings</div>
                <div style="width: 40px;"></div>
            </div>
            <div class="settings-content">
                <div class="settings-group">
                    <div class="settings-group-title" data-lang="zh">常规</div>
                    <div class="settings-group-title hidden" data-lang="en">General</div>
                    <div class="settings-item" id="languageSetting">
                        <div class="settings-item-label" data-lang="zh">语言</div>
                        <div class="settings-item-label hidden" data-lang="en">Language</div>
                        <div class="settings-item-value" id="languageValue">
                            <span data-lang="zh">中文</span>
                            <span class="hidden" data-lang="en">English</span>
                            <span style="margin-left: 8px;">›</span>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-label" data-lang="zh">深色模式</div>
                        <div class="settings-item-label hidden" data-lang="en">Dark Mode</div>
                        <div class="settings-switch" id="darkModeSwitch"></div>
                    </div>
                </div>
                <div class="settings-group">
                    <div class="settings-group-title" data-lang="zh">数据</div>
                    <div class="settings-group-title hidden" data-lang="en">Data</div>
                    <div class="settings-item" id="clearData">
                        <div class="settings-item-label" data-lang="zh">清除所有数据</div>
                        <div class="settings-item-label hidden" data-lang="en">Clear All Data</div>
                        <div class="settings-item-value">
                            <span style="color: var(--danger-color);" data-lang="zh">清除</span>
                            <span style="color: var(--danger-color);" class="hidden" data-lang="en">Clear</span>
                        </div>
                    </div>
                </div>
                <div class="settings-group">
                    <div class="settings-group-title" data-lang="zh">关于</div>
                    <div class="settings-group-title hidden" data-lang="en">About</div>
                    <div class="settings-item">
                        <div class="settings-item-label" data-lang="zh">版本</div>
                        <div class="settings-item-label hidden" data-lang="en">Version</div>
                        <div class="settings-item-value">1.0.0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 联系我们弹窗 -->
        <div class="contact-popup" id="contactPopup">
            <div class="contact-title" data-lang="zh">联系我们</div>
            <div class="contact-title hidden" data-lang="en">Contact Us</div>
            <div class="contact-email">Cyinhaos@gmail.com</div>
            <button class="contact-close" id="closeContact" data-lang="zh">关闭</button>
            <button class="contact-close hidden" id="closeContact-en" data-lang="en">Close</button>
        </div>

        <!-- 标签选择弹窗 -->
        <div class="tag-popup" id="tagPopup">
            <div class="tag-popup-title" data-lang="zh">选择标签</div>
            <div class="tag-popup-title hidden" data-lang="en">Select Tags</div>
            <div class="tag-list" id="tagList">
                <!-- 标签将通过JavaScript动态生成 -->
            </div>
            <div class="tag-popup-actions">
                <div class="tag-popup-cancel" id="cancelTag" data-lang="zh">取消</div>
                <div class="tag-popup-cancel hidden" id="cancelTag-en" data-lang="en">Cancel</div>
                <div class="tag-popup-confirm" id="confirmTag" data-lang="zh">确认</div>
                <div class="tag-popup-confirm hidden" id="confirmTag-en" data-lang="en">Confirm</div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let notes = [];
        let deletedNotes = [];
        let currentNoteId = null;
        let selectedTags = [];
        let currentLanguage = 'zh'; // 默认语言为中文
        let isDarkMode = false;

        // 滑动删除相关变量
        let touchStartX = 0;
        let touchEndX = 0;
        let currentSwipedElement = null;

        // 预定义标签
        const predefinedTags = [
            { id: 1, name: { zh: '工作', en: 'Work' }, color: '#007AFF' },
            { id: 2, name: { zh: '个人', en: 'Personal' }, color: '#5AC8FA' },
            { id: 3, name: { zh: '重要', en: 'Important' }, color: '#FF9500' },
            { id: 4, name: { zh: '创意', en: 'Creative' }, color: '#FF2D55' },
            { id: 5, name: { zh: '旅行', en: 'Travel' }, color: '#4CD964' },
            { id: 6, name: { zh: '学习', en: 'Study' }, color: '#5856D6' }
        ];

        // DOM元素
        const menuButton = document.getElementById('menuButton');
        const sideMenu = document.getElementById('sideMenu');
        const menuOverlay = document.getElementById('menuOverlay');
        const searchButton = document.getElementById('searchButton');
        const addButton = document.getElementById('addButton');
        const notesContainer = document.getElementById('notesContainer');
        const editPage = document.getElementById('editPage');
        const editTitle = document.getElementById('editTitle');
        const editTitleEn = document.getElementById('editTitle-en');
        const editBody = document.getElementById('editBody');
        const editBodyEn = document.getElementById('editBody-en');
        const editTags = document.getElementById('editTags');
        const addTag = document.getElementById('addTag');
        const cancelEdit = document.getElementById('cancelEdit');
        const cancelEditEn = document.getElementById('cancelEdit-en');
        const saveNote = document.getElementById('saveNote');
        const saveNoteEn = document.getElementById('saveNote-en');
        const searchPage = document.getElementById('searchPage');
        const searchInput = document.getElementById('searchInput');
        const searchInputEn = document.getElementById('searchInput-en');
        const searchResults = document.getElementById('searchResults');
        const cancelSearch = document.getElementById('cancelSearch');
        const cancelSearchEn = document.getElementById('cancelSearch-en');
        const deletedPage = document.getElementById('deletedPage');
        const deletedContainer = document.getElementById('deletedContainer');
        const backFromDeleted = document.getElementById('backFromDeleted');
        const restoreAll = document.getElementById('restoreAll');
        const restoreAllEn = document.getElementById('restoreAll-en');
        const deleteAll = document.getElementById('deleteAll');
        const deleteAllEn = document.getElementById('deleteAll-en');
        const settingsPage = document.getElementById('settingsPage');
        const backFromSettings = document.getElementById('backFromSettings');
        const languageSetting = document.getElementById('languageSetting');
        const darkModeSwitch = document.getElementById('darkModeSwitch');
        const clearData = document.getElementById('clearData');
        const contactPopup = document.getElementById('contactPopup');
        const closeContact = document.getElementById('closeContact');
        const closeContactEn = document.getElementById('closeContact-en');
        const tagPopup = document.getElementById('tagPopup');
        const tagList = document.getElementById('tagList');
        const cancelTag = document.getElementById('cancelTag');
        const cancelTagEn = document.getElementById('cancelTag-en');
        const confirmTag = document.getElementById('confirmTag');
        const confirmTagEn = document.getElementById('confirmTag-en');
        const menuHome = document.getElementById('menuHome');
        const menuDeleted = document.getElementById('menuDeleted');
        const menuContact = document.getElementById('menuContact');
        const menuSettings = document.getElementById('menuSettings');

        // 初始化应用
        function initApp() {
            loadData();
            renderNotes();
            setupEventListeners();
            updateLanguage();
            applyTheme();
        }

        // 加载数据
        function loadData() {
            const savedNotes = localStorage.getItem('memonest_notes');
            const savedDeletedNotes = localStorage.getItem('memonest_deleted_notes');
            const savedLanguage = localStorage.getItem('memonest_language');
            const savedTheme = localStorage.getItem('memonest_theme');

            if (savedNotes) {
                notes = JSON.parse(savedNotes);
            } else {
                // 添加示例笔记
                notes = [
                    {
                        id: 1,
                        title: { zh: '欢迎使用MemoNest', en: 'Welcome to MemoNest' },
                        content: { 
                            zh: '这是一个简单而强大的备忘录应用，您可以在这里记录您的想法、任务和灵感。\n\n点击右上角的"+"按钮创建新笔记，或者点击左上角的菜单图标探索更多功能。\n\n向左滑动笔记可以快速删除。', 
                            en: 'This is a simple yet powerful note-taking app where you can record your thoughts, tasks, and inspirations.\n\nClick the "+" button in the top right corner to create a new note, or click the menu icon in the top left corner to explore more features.\n\nSwipe left on a note to quickly delete it.'
                        },
                        date: new Date().toISOString(),
                        tags: [1, 5]
                    }
                ];
                saveNotes();
            }

            if (savedDeletedNotes) {
                deletedNotes = JSON.parse(savedDeletedNotes);
            }

            if (savedLanguage) {
                currentLanguage = savedLanguage;
            }

            if (savedTheme === 'dark') {
                isDarkMode = true;
            }
        }

        // 保存笔记到本地存储
        function saveNotes() {
            localStorage.setItem('memonest_notes', JSON.stringify(notes));
        }

        // 保存已删除笔记到本地存储
        function saveDeletedNotes() {
            localStorage.setItem('memonest_deleted_notes', JSON.stringify(deletedNotes));
        }

        // 渲染笔记列表
        function renderNotes() {
            notesContainer.innerHTML = '';

            if (notes.length === 0) {
                renderEmptyState(notesContainer, 'notes');
                return;
            }

            // 按日期排序，最新的在前面
            const sortedNotes = [...notes].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedNotes.forEach(note => {
                const noteCard = createNoteCard(note);
                notesContainer.appendChild(noteCard);
            });
        }

        // 创建笔记卡片（带滑动删除功能）
        function createNoteCard(note) {
            // 创建卡片包装器（用于滑动删除）
            const noteCardWrapper = document.createElement('div');
            noteCardWrapper.className = 'note-card-wrapper slide-up';
            noteCardWrapper.dataset.id = note.id;

            // 创建卡片内容
            const noteCardContent = document.createElement('div');
            noteCardContent.className = 'note-card-content';

            // 创建删除按钮
            const deleteButton = document.createElement('div');
            deleteButton.className = 'note-card-delete';
            deleteButton.textContent = currentLanguage === 'zh' ? '删除' : 'Delete';

            // 添加卡片内容
            const title = document.createElement('div');
            title.className = 'note-title';
            title.textContent = note.title[currentLanguage];

            const preview = document.createElement('div');
            preview.className = 'note-preview';
            preview.textContent = note.content[currentLanguage];

            const date = document.createElement('div');
            date.className = 'note-date';
            date.textContent = formatDate(note.date);

            const tagsContainer = document.createElement('div');
            tagsContainer.className = 'note-tags';

            if (note.tags && note.tags.length > 0) {
                note.tags.forEach(tagId => {
                    const tag = predefinedTags.find(t => t.id === tagId);
                    if (tag) {
                        const tagElement = document.createElement('div');
                        tagElement.className = 'note-tag';
                        tagElement.textContent = tag.name[currentLanguage];
                        tagElement.style.backgroundColor = `${tag.color}20`;
                        tagElement.style.color = tag.color;
                        tagsContainer.appendChild(tagElement);
                    }
                });
            }

            noteCardContent.appendChild(title);
            noteCardContent.appendChild(preview);
            noteCardContent.appendChild(date);
            noteCardContent.appendChild(tagsContainer);

            // 添加触摸事件监听器（滑动删除）
            setupSwipeToDelete(noteCardWrapper, noteCardContent, deleteButton, note.id);

            // 点击笔记卡片打开编辑页面
            noteCardContent.addEventListener('click', () => {
                // 如果卡片正在滑动状态，不触发点击
                if (noteCardContent.style.transform && noteCardContent.style.transform !== 'translateX(0px)') {
                    return;
                }
                openEditPage(note.id);
            });

            // 点击删除按钮删除笔记
            deleteButton.addEventListener('click', (e) => {
                e.stopPropagation();
                deleteNote(note.id);
            });

            // 组装卡片
            noteCardWrapper.appendChild(deleteButton);
            noteCardWrapper.appendChild(noteCardContent);

            return noteCardWrapper;
        }

        // 设置滑动删除功能
        function setupSwipeToDelete(wrapper, content, deleteButton, noteId) {
            let startX, moveX, startTime;
            let isSwiping = false;
            const threshold = 80; // 滑动阈值，超过这个值才会触发删除

            // 触摸开始
            content.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startTime = new Date().getTime();
                isSwiping = true;

                // 如果有其他已经滑出的卡片，先重置它们
                if (currentSwipedElement && currentSwipedElement !== content) {
                    currentSwipedElement.style.transform = 'translateX(0)';
                }
            });

            // 触摸移动
            content.addEventListener('touchmove', (e) => {
                if (!isSwiping) return;
                
                moveX = e.touches[0].clientX;
                const diff = moveX - startX;
                
                // 只允许向左滑动（负值）
                if (diff < 0) {
                    // 限制最大滑动距离为删除按钮宽度
                    const translateX = Math.max(diff, -80);
                    content.style.transform = `translateX(${translateX}px)`;
                    
                    // 如果滑动距离超过阈值，标记当前滑动元素
                    if (Math.abs(translateX) >= threshold) {
                        currentSwipedElement = content;
                    }
                }
            });

            // 触摸结束
            content.addEventListener('touchend', (e) => {
                if (!isSwiping) return;
                isSwiping = false;
                
                const endX = e.changedTouches[0].clientX;
                const diff = endX - startX;
                const endTime = new Date().getTime();
                const duration = endTime - startTime;
                
                // 计算滑动速度
                const velocity = Math.abs(diff) / duration;
                
                // 如果滑动距离超过阈值或者滑动速度足够快，完成滑动动作
                if (diff < -threshold || (diff < 0 && velocity > 0.3)) {
                    content.style.transform = 'translateX(-80px)';
                    currentSwipedElement = content;
                } else {
                    // 否则恢复原位
                    content.style.transform = 'translateX(0)';
                    currentSwipedElement = null;
                }
            });

            // 点击其他区域时重置滑动状态
            document.addEventListener('click', (e) => {
                if (currentSwipedElement && !wrapper.contains(e.target)) {
                    currentSwipedElement.style.transform = 'translateX(0)';
                    currentSwipedElement = null;
                }
            });
        }

        // 渲染已删除笔记列表
        function renderDeletedNotes() {
            deletedContainer.innerHTML = '';

            if (deletedNotes.length === 0) {
                renderEmptyState(deletedContainer, 'deleted');
                return;
            }

            // 按日期排序，最新的在前面
            const sortedNotes = [...deletedNotes].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedNotes.forEach(note => {
                const noteCard = createDeletedNoteCard(note);
                deletedContainer.appendChild(noteCard);
            });
        }

        // 创建已删除笔记卡片
        function createDeletedNoteCard(note) {
            const noteCard = document.createElement('div');
            noteCard.className = 'note-card slide-up';
            noteCard.dataset.id = note.id;

            const title = document.createElement('div');
            title.className = 'note-title';
            title.textContent = note.title[currentLanguage];

            const preview = document.createElement('div');
            preview.className = 'note-preview';
            preview.textContent = note.content[currentLanguage];

            const date = document.createElement('div');
            date.className = 'note-date';
            date.textContent = formatDate(note.date);

            const actions = document.createElement('div');
            actions.className = 'note-tags';

            const restoreButton = document.createElement('div');
            restoreButton.className = 'note-tag';
            restoreButton.style.backgroundColor = `${predefinedTags[0].color}20`;
            restoreButton.style.color = predefinedTags[0].color;
            restoreButton.textContent = currentLanguage === 'zh' ? '恢复' : 'Restore';
            restoreButton.addEventListener('click', (e) => {
                e.stopPropagation();
                restoreNote(note.id);
            });

            const deleteButton = document.createElement('div');
            deleteButton.className = 'note-tag';
            deleteButton.style.backgroundColor = `${predefinedTags[3].color}20`;
            deleteButton.style.color = predefinedTags[3].color;
            deleteButton.textContent = currentLanguage === 'zh' ? '删除' : 'Delete';
            deleteButton.addEventListener('click', (e) => {
                e.stopPropagation();
                permanentlyDeleteNote(note.id);
            });

            actions.appendChild(restoreButton);
            actions.appendChild(deleteButton);

            noteCard.appendChild(title);
            noteCard.appendChild(preview);
            noteCard.appendChild(date);
            noteCard.appendChild(actions);

            return noteCard;
        }

        // 渲染空状态
        function renderEmptyState(container, type) {
            const emptyState = document.createElement('div');
            emptyState.className = 'empty-state';

            const icon = document.createElement('div');
            icon.className = 'empty-icon';
            
            const title = document.createElement('div');
            title.className = 'empty-title';
            
            const description = document.createElement('div');
            description.className = 'empty-description';
            
            const action = document.createElement('div');
            action.className = 'empty-action';

            if (type === 'notes') {
                icon.textContent = '📝';
                title.textContent = currentLanguage === 'zh' ? '没有笔记' : 'No Notes';
                description.textContent = currentLanguage === 'zh' ? 
                    '您还没有创建任何笔记。点击下方按钮开始创建您的第一个笔记。' : 
                    'You haven\'t created any notes yet. Click the button below to create your first note.';
                action.textContent = currentLanguage === 'zh' ? '创建笔记' : 'Create Note';
                action.addEventListener('click', () => {
                    openEditPage();
                });
            } else if (type === 'deleted') {
                icon.textContent = '🗑️';
                title.textContent = currentLanguage === 'zh' ? '没有已删除的笔记' : 'No Deleted Notes';
                description.textContent = currentLanguage === 'zh' ? 
                    '回收站是空的。当您删除笔记时，它们会出现在这里。' : 
                    'The trash is empty. When you delete notes, they will appear here.';
            } else if (type === 'search') {
                icon.textContent = '🔍';
                title.textContent = currentLanguage === 'zh' ? '没有搜索结果' : 'No Search Results';
                description.textContent = currentLanguage === 'zh' ? 
                    '没有找到匹配的笔记。尝试使用不同的关键词。' : 
                    'No matching notes found. Try using different keywords.';
            }

            emptyState.appendChild(icon);
            emptyState.appendChild(title);
            emptyState.appendChild(description);
            
            if (type === 'notes') {
                emptyState.appendChild(action);
            }

            container.appendChild(emptyState);
        }

        // 打开编辑页面
        function openEditPage(noteId = null) {
            currentNoteId = noteId;
            selectedTags = [];

            if (noteId) {
                // 编辑现有笔记
                const note = notes.find(n => n.id === noteId);
                if (note) {
                    editTitle.value = note.title.zh || '';
                    editTitleEn.value = note.title.en || '';
                    editBody.value = note.content.zh || '';
                    editBodyEn.value = note.content.en || '';
                    selectedTags = note.tags || [];
                }
            } else {
                // 创建新笔记
                editTitle.value = '';
                editTitleEn.value = '';
                editBody.value = '';
                editBodyEn.value = '';
                selectedTags = [];
            }

            renderSelectedTags();
            editPage.classList.add('open');
        }

        // 关闭编辑页面
        function closeEditPage() {
            editPage.classList.remove('open');
            currentNoteId = null;
            selectedTags = [];
        }

        // 保存笔记
        function saveCurrentNote() {
            const titleZh = editTitle.value.trim();
            const titleEn = editTitleEn.value.trim();
            const contentZh = editBody.value.trim();
            const contentEn = editBodyEn.value.trim();

            // 如果标题和内容都为空，则不保存
            if (!titleZh && !contentZh && !titleEn && !contentEn) {
                closeEditPage();
                return;
            }

            // 如果只填写了一种语言，自动复制到另一种语言
            const finalTitleZh = titleZh || titleEn;
            const finalTitleEn = titleEn || titleZh;
            const finalContentZh = contentZh || contentEn;
            const finalContentEn = contentEn || contentZh;

            if (currentNoteId) {
                // 更新现有笔记
                const noteIndex = notes.findIndex(n => n.id === currentNoteId);
                if (noteIndex !== -1) {
                    notes[noteIndex] = {
                        ...notes[noteIndex],
                        title: { zh: finalTitleZh, en: finalTitleEn },
                        content: { zh: finalContentZh, en: finalContentEn },
                        date: new Date().toISOString(),
                        tags: selectedTags
                    };
                }
            } else {
                // 创建新笔记
                const newNote = {
                    id: Date.now(),
                    title: { zh: finalTitleZh, en: finalTitleEn },
                    content: { zh: finalContentZh, en: finalContentEn },
                    date: new Date().toISOString(),
                    tags: selectedTags
                };
                notes.push(newNote);
            }

            saveNotes();
            renderNotes();
            closeEditPage();
        }

        // 删除笔记
        function deleteNote(noteId) {
            const noteIndex = notes.findIndex(n => n.id === noteId);
            if (noteIndex !== -1) {
                const deletedNote = notes.splice(noteIndex, 1)[0];
                deletedNotes.push(deletedNote);
                saveNotes();
                saveDeletedNotes();
                renderNotes();
            }
        }

        // 恢复笔记
        function restoreNote(noteId) {
            const noteIndex = deletedNotes.findIndex(n => n.id === noteId);
            if (noteIndex !== -1) {
                const restoredNote = deletedNotes.splice(noteIndex, 1)[0];
                notes.push(restoredNote);
                saveNotes();
                saveDeletedNotes();
                renderDeletedNotes();
            }
        }

        // 永久删除笔记
        function permanentlyDeleteNote(noteId) {
            const noteIndex = deletedNotes.findIndex(n => n.id === noteId);
            if (noteIndex !== -1) {
                deletedNotes.splice(noteIndex, 1);
                saveDeletedNotes();
                renderDeletedNotes();
            }
        }

        // 恢复所有已删除笔记
        function restoreAllNotes() {
            if (deletedNotes.length === 0) return;

            notes = [...notes, ...deletedNotes];
            deletedNotes = [];
            saveNotes();
            saveDeletedNotes();
            renderDeletedNotes();
        }

        // 永久删除所有已删除笔记
        function deleteAllNotes() {
            if (deletedNotes.length === 0) return;

            deletedNotes = [];
            saveDeletedNotes();
            renderDeletedNotes();
        }

        // 搜索笔记
        function searchNotes(query) {
            if (!query) {
                searchResults.innerHTML = '';
                renderEmptyState(searchResults, 'search');
                return;
            }

            const results = notes.filter(note => {
                const titleMatch = note.title[currentLanguage].toLowerCase().includes(query.toLowerCase());
                const contentMatch = note.content[currentLanguage].toLowerCase().includes(query.toLowerCase());
                return titleMatch || contentMatch;
            });

            searchResults.innerHTML = '';

            if (results.length === 0) {
                renderEmptyState(searchResults, 'search');
                return;
            }

            results.forEach(note => {
                const noteCard = createNoteCard(note);
                searchResults.appendChild(noteCard);
            });
        }

        // 渲染已选择的标签
        function renderSelectedTags() {
            editTags.innerHTML = '';

            selectedTags.forEach(tagId => {
                const tag = predefinedTags.find(t => t.id === tagId);
                if (tag) {
                    const tagElement = document.createElement('div');
                    tagElement.className = 'edit-tag';
                    tagElement.textContent = tag.name[currentLanguage];
                    tagElement.style.backgroundColor = `${tag.color}20`;
                    tagElement.style.color = tag.color;

                    const removeButton = document.createElement('span');
                    removeButton.className = 'edit-tag-remove';
                    removeButton.textContent = '×';
                    removeButton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        selectedTags = selectedTags.filter(id => id !== tagId);
                        renderSelectedTags();
                    });

                    tagElement.appendChild(removeButton);
                    editTags.appendChild(tagElement);
                }
            });
        }

        // 打开标签选择弹窗
        function openTagPopup() {
            renderTagList();
            tagPopup.classList.add('open');
        }

        // 关闭标签选择弹窗
        function closeTagPopup() {
            tagPopup.classList.remove('open');
        }

        // 渲染标签列表
        function renderTagList() {
            tagList.innerHTML = '';

            predefinedTags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag-item';
                tagElement.textContent = tag.name[currentLanguage];
                tagElement.style.backgroundColor = `${tag.color}20`;
                tagElement.style.color = tag.color;
                tagElement.dataset.id = tag.id;

                if (selectedTags.includes(tag.id)) {
                    tagElement.classList.add('selected');
                }

                tagElement.addEventListener('click', () => {
                    tagElement.classList.toggle('selected');
                });

                tagList.appendChild(tagElement);
            });
        }

        // 确认标签选择
        function confirmTagSelection() {
            const selectedElements = tagList.querySelectorAll('.tag-item.selected');
            selectedTags = Array.from(selectedElements).map(el => parseInt(el.dataset.id));
            renderSelectedTags();
            closeTagPopup();
        }

        // 打开联系我们弹窗
        function openContactPopup() {
            contactPopup.classList.add('open');
            menuOverlay.classList.add('open');
        }

        // 关闭联系我们弹窗
        function closeContactPopup() {
            contactPopup.classList.remove('open');
            menuOverlay.classList.remove('open');
        }

        // 打开侧边菜单
        function openSideMenu() {
            sideMenu.classList.add('open');
            menuOverlay.classList.add('open');
        }

        // 关闭侧边菜单
        function closeSideMenu() {
            sideMenu.classList.remove('open');
            menuOverlay.classList.remove('open');
        }

        // 打开搜索页面
        function openSearchPage() {
            searchPage.classList.add('open');
            setTimeout(() => {
                searchInput.focus();
            }, 300);
        }

        // 关闭搜索页面
        function closeSearchPage() {
            searchPage.classList.remove('open');
            searchInput.value = '';
            searchInputEn.value = '';
            searchResults.innerHTML = '';
        }

        // 打开已删除笔记页面
        function openDeletedPage() {
            renderDeletedNotes();
            deletedPage.classList.add('open');
            closeSideMenu();
        }

        // 关闭已删除笔记页面
        function closeDeletedPage() {
            deletedPage.classList.remove('open');
        }

        // 打开设置页面
        function openSettingsPage() {
            settingsPage.classList.add('open');
            closeSideMenu();
            
            // 更新深色模式开关状态
            if (isDarkMode) {
                darkModeSwitch.classList.add('active');
            } else {
                darkModeSwitch.classList.remove('active');
            }
        }

        // 关闭设置页面
        function closeSettingsPage() {
            settingsPage.classList.remove('open');
        }

        // 切换语言
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'zh' ? 'en' : 'zh';
            localStorage.setItem('memonest_language', currentLanguage);
            updateLanguage();
            renderNotes();
        }

        // 更新界面语言
        function updateLanguage() {
            // 隐藏所有语言元素
            document.querySelectorAll('[data-lang]').forEach(el => {
                el.classList.add('hidden');
            });

            // 显示当前语言元素
            document.querySelectorAll(`[data-lang="${currentLanguage}"]`).forEach(el => {
                el.classList.remove('hidden');
            });

            // 更新占位符文本
            document.querySelectorAll(`[data-lang-placeholder="${currentLanguage}"]`).forEach(el => {
                el.classList.remove('hidden');
            });
            document.querySelectorAll(`[data-lang-placeholder]:not([data-lang-placeholder="${currentLanguage}"])`).forEach(el => {
                el.classList.add('hidden');
            });
        }

        // 切换深色模式
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            localStorage.setItem('memonest_theme', isDarkMode ? 'dark' : 'light');
            applyTheme();
        }

        // 应用主题
        function applyTheme() {
            if (isDarkMode) {
                document.body.setAttribute('data-theme', 'dark');
                darkModeSwitch.classList.add('active');
            } else {
                document.body.removeAttribute('data-theme');
                darkModeSwitch.classList.remove('active');
            }
        }

        // 清除所有数据
        function clearAllData() {
            if (confirm(currentLanguage === 'zh' ? '确定要清除所有数据吗？此操作不可撤销。' : 'Are you sure you want to clear all data? This action cannot be undone.')) {
                localStorage.removeItem('memonest_notes');
                localStorage.removeItem('memonest_deleted_notes');
                notes = [];
                deletedNotes = [];
                renderNotes();
            }
        }

        // 格式化日期
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffMs = now - date;
            const diffSec = Math.floor(diffMs / 1000);
            const diffMin = Math.floor(diffSec / 60);
            const diffHour = Math.floor(diffMin / 60);
            const diffDay = Math.floor(diffHour / 24);

            if (diffDay > 0) {
                if (diffDay === 1) {
                    return currentLanguage === 'zh' ? '昨天' : 'Yesterday';
                } else if (diffDay < 7) {
                    return currentLanguage === 'zh' ? `${diffDay}天前` : `${diffDay} days ago`;
                } else {
                    const options = { year: 'numeric', month: 'short', day: 'numeric' };
                    return date.toLocaleDateString(currentLanguage === 'zh' ? 'zh-CN' : 'en-US', options);
                }
            } else if (diffHour > 0) {
                return currentLanguage === 'zh' ? `${diffHour}小时前` : `${diffHour} hours ago`;
            } else if (diffMin > 0) {
                return currentLanguage === 'zh' ? `${diffMin}分钟前` : `${diffMin} minutes ago`;
            } else {
                return currentLanguage === 'zh' ? '刚刚' : 'Just now';
            }
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 菜单按钮
            menuButton.addEventListener('click', openSideMenu);
            menuOverlay.addEventListener('click', closeSideMenu);

            // 搜索按钮
            searchButton.addEventListener('click', openSearchPage);
            cancelSearch.addEventListener('click', closeSearchPage);
            cancelSearchEn.addEventListener('click', closeSearchPage);
            searchInput.addEventListener('input', () => searchNotes(searchInput.value));
            searchInputEn.addEventListener('input', () => searchNotes(searchInputEn.value));

            // 添加按钮
            addButton.addEventListener('click', () => openEditPage());

            // 编辑页面
            cancelEdit.addEventListener('click', closeEditPage);
            cancelEditEn.addEventListener('click', closeEditPage);
            saveNote.addEventListener('click', saveCurrentNote);
            saveNoteEn.addEventListener('click', saveCurrentNote);
            addTag.addEventListener('click', openTagPopup);

            // 标签弹窗
            cancelTag.addEventListener('click', closeTagPopup);
            cancelTagEn.addEventListener('click', closeTagPopup);
            confirmTag.addEventListener('click', confirmTagSelection);
            confirmTagEn.addEventListener('click', confirmTagSelection);

            // 已删除笔记页面
            backFromDeleted.addEventListener('click', closeDeletedPage);
            restoreAll.addEventListener('click', restoreAllNotes);
            restoreAllEn.addEventListener('click', restoreAllNotes);
            deleteAll.addEventListener('click', deleteAllNotes);
            deleteAllEn.addEventListener('click', deleteAllNotes);

            // 设置页面
            backFromSettings.addEventListener('click', closeSettingsPage);
            languageSetting.addEventListener('click', toggleLanguage);
            darkModeSwitch.addEventListener('click', toggleDarkMode);
            clearData.addEventListener('click', clearAllData);

            // 联系我们弹窗
            closeContact.addEventListener('click', closeContactPopup);
            closeContactEn.addEventListener('click', closeContactPopup);

            // 菜单项
            menuHome.addEventListener('click', closeSideMenu);
            menuDeleted.addEventListener('click', openDeletedPage);
            menuContact.addEventListener('click', openContactPopup);
            menuSettings.addEventListener('click', openSettingsPage);
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
